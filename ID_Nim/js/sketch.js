// Generated by CoffeeScript 2.4.1
var Nim, app, draw, mousePressed, setup;

app = null;

Nim = class Nim {
  constructor() {
    this.RADIUS = 30;
    this.BUTTONS = [[35, 80], [100, 80], [165, 80], [35, 150, 'ok'], [100, 150, 'x'], [165, 150, 'hint']];
    this.newGame();
    this.init();
  }

  init() {
    this.active = -1;
    this.player = 0;
    return this.original = this.board.slice(0);
  }

  move(index) {
    var ref;
    if ((ref = this.active) === index || ref === (-1)) {
      this.active = index;
      return this.board[this.active] = constrain(this.board[this.active] - 1, 0, 99);
    }
  }

  newGame() {
    var a, b, c;
    [a, b, c] = [_.random(1, 6), _.random(1, 6), _.random(1, 6)];
    this.board = [a, a + b, a + b + c];
    return this.init();
  }

  ok() {
    if (this.active === -1) {
      return;
    }
    this.player = 1 - this.player;
    this.active = -1;
    return this.original = this.board.slice(0);
  }

  cancel() {
    this.board = this.original;
    return this.active = -1;
  }

  draw() {
    var i, j, len, ref, txt, x, y;
    textAlign(CENTER, CENTER);
    textSize(32);
    bg(0);
    ref = this.BUTTONS;
    for (i = j = 0, len = ref.length; j < len; i = ++j) {
      [x, y, txt] = ref[i];
      fc(0);
      sc(1);
      sw(2);
      if (i <= 2 && this.active === -1 || this.active === i) {
        circle(x, y, this.RADIUS);
      }
      if ((i === 3 || i === 4) && this.active !== -1) {
        circle(x, y, this.RADIUS);
      }
      if (i === 5 && this.active === -1) {
        circle(x, y, this.RADIUS);
      }
      fc(1);
      sc();
      if (i <= 2) {
        text(this.board[i], x, y);
      }
      if (i >= 3) {
        text(txt, x, y);
      }
    }
    fc(1, this.player, 0);
    return circle(20 + this.player * 160, 20, 10);
  }

  hint() {
    var a, b, board, c;
    if (this.active !== -1) {
      return;
    }
    [a, b, c] = this.board;
    board = (b ^ c) < a ? [b ^ c, b, c] : (a ^ c) < b ? [a, a ^ c, c] : (a ^ b) < c ? [a, b, a ^ b] : [a, b, c];
    if (!_.isEqual(board, this.board)) {
      this.board = board;
      return this.player = 1 - this.player;
    }
  }

  mousePressed(mx, my) {
    var button, i, index, j, len, ref;
    index = -1;
    ref = this.BUTTONS;
    for (i = j = 0, len = ref.length; j < len; i = ++j) {
      button = ref[i];
      if (dist(button[0], button[1], mx, my) < this.RADIUS) {
        index = i;
      }
    }
    if (index <= 2) {
      this.move(index);
    }
    if (index === 3) {
      this.ok();
    }
    if (index === 4) {
      this.cancel();
    }
    if (index === 5) {
      return this.hint();
    }
  }

};

setup = function() {
  createCanvas(200, 200);
  app = new Nim;
  return button('newGame', () => {
    return app.newGame();
  });
};

draw = function() {
  return app.draw();
};

mousePressed = function(event) {
  return app.mousePressed(event.x, event.y);
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQSxJQUFBLEVBQUEsWUFBQSxFQUFBOztBQUFBLEdBQUEsR0FBTTs7QUFFQSxNQUFOLE1BQUEsSUFBQTtFQUNDLFdBQWMsQ0FBQSxDQUFBO0lBQ2IsSUFBQyxDQUFBLE1BQUQsR0FBVTtJQUNWLElBQUMsQ0FBQSxPQUFELEdBQVcsQ0FBQyxDQUFDLEVBQUQsRUFBSSxFQUFKLENBQUQsRUFBUyxDQUFDLEdBQUQsRUFBSyxFQUFMLENBQVQsRUFBa0IsQ0FBQyxHQUFELEVBQUssRUFBTCxDQUFsQixFQUE0QixDQUFDLEVBQUQsRUFBSSxHQUFKLEVBQVEsSUFBUixDQUE1QixFQUEwQyxDQUFDLEdBQUQsRUFBSyxHQUFMLEVBQVMsR0FBVCxDQUExQyxFQUF3RCxDQUFDLEdBQUQsRUFBSyxHQUFMLEVBQVMsTUFBVCxDQUF4RDtJQUNYLElBQUMsQ0FBQSxPQUFELENBQUE7SUFDQSxJQUFDLENBQUEsSUFBRCxDQUFBO0VBSmE7O0VBTWQsSUFBTyxDQUFBLENBQUE7SUFDTixJQUFDLENBQUEsTUFBRCxHQUFVLENBQUM7SUFDWCxJQUFDLENBQUEsTUFBRCxHQUFVO1dBQ1YsSUFBQyxDQUFBLFFBQUQsR0FBWSxJQUFDLENBQUEsS0FBTTtFQUhiOztFQUtQLElBQU8sQ0FBQyxLQUFELENBQUE7QUFDTixRQUFBO0lBQUEsV0FBRyxJQUFDLENBQUEsT0FBRCxLQUFZLEtBQVosSUFBQSxHQUFBLE1BQWtCLENBQUMsRUFBdEI7TUFDQyxJQUFDLENBQUEsTUFBRCxHQUFVO2FBQ1YsSUFBQyxDQUFBLEtBQU0sQ0FBQSxJQUFDLENBQUEsTUFBRCxDQUFQLEdBQWtCLFNBQUEsQ0FBVSxJQUFDLENBQUEsS0FBTSxDQUFBLElBQUMsQ0FBQSxNQUFELENBQVAsR0FBZ0IsQ0FBMUIsRUFB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LElBQUcsS0FBQSxLQUFTLENBQVo7TUFBbUIsSUFBQyxDQUFBLEVBQUQsQ0FBQSxFQUFuQjs7SUFDQSxJQUFHLEtBQUEsS0FBUyxDQUFaO01BQW1CLElBQUMsQ0FBQSxNQUFELENBQUEsRUFBbkI7O0lBQ0EsSUFBRyxLQUFBLEtBQVMsQ0FBWjthQUFtQixJQUFDLENBQUEsSUFBRCxDQUFBLEVBQW5COztFQVBjOztBQTFEaEI7O0FBbUVBLEtBQUEsR0FBUSxRQUFBLENBQUEsQ0FBQTtFQUNQLFlBQUEsQ0FBYSxHQUFiLEVBQWlCLEdBQWpCO0VBQ0EsR0FBQSxHQUFNLElBQUk7U0FDVixNQUFBLENBQU8sU0FBUCxFQUFpQixDQUFBLENBQUEsR0FBQTtXQUFNLEdBQUcsQ0FBQyxPQUFKLENBQUE7RUFBTixDQUFqQjtBQUhPOztBQUtSLElBQUEsR0FBTyxRQUFBLENBQUEsQ0FBQTtTQUFHLEdBQUcsQ0FBQyxJQUFKLENBQUE7QUFBSDs7QUFDUCxZQUFBLEdBQWUsUUFBQSxDQUFDLEtBQUQsQ0FBQTtTQUFXLEdBQUcsQ0FBQyxZQUFKLENBQWlCLEtBQUssQ0FBQyxDQUF2QixFQUEwQixLQUFLLENBQUMsQ0FBaEM7QUFBWCIsInNvdXJjZXNDb250ZW50IjpbImFwcCA9IG51bGxcclxuXHJcbmNsYXNzIE5pbVxyXG5cdGNvbnN0cnVjdG9yIDogLT5cclxuXHRcdEBSQURJVVMgPSAzMFxyXG5cdFx0QEJVVFRPTlMgPSBbWzM1LDgwXSxbMTAwLDgwXSxbMTY1LDgwXSwgWzM1LDE1MCwnb2snXSxbMTAwLDE1MCwneCddLFsxNjUsMTUwLCdoaW50J11dXHJcblx0XHRAbmV3R2FtZSgpXHJcblx0XHRAaW5pdCgpXHJcblxyXG5cdGluaXQgOiAtPlxyXG5cdFx0QGFjdGl2ZSA9IC0xXHJcblx0XHRAcGxheWVyID0gMFxyXG5cdFx0QG9yaWdpbmFsID0gQGJvYXJkWy4uXVxyXG5cclxuXHRtb3ZlIDogKGluZGV4KSAtPlxyXG5cdFx0aWYgQGFjdGl2ZSBpbiBbaW5kZXgsLTFdXHJcblx0XHRcdEBhY3RpdmUgPSBpbmRleFxyXG5cdFx0XHRAYm9hcmRbQGFjdGl2ZV0gPSBjb25zdHJhaW4gQGJvYXJkW0BhY3RpdmVdLTEsIDAsIDk5XHJcblxyXG5cdG5ld0dhbWUgOiAtPlxyXG5cdFx0W2EsYixjXSA9IFtfLnJhbmRvbSgxLDYpLCBfLnJhbmRvbSgxLDYpLCBfLnJhbmRvbSgxLDYpXVxyXG5cdFx0QGJvYXJkID0gW2EsYStiLGErYitjXVxyXG5cdFx0QGluaXQoKVxyXG5cclxuXHRvayA6IC0+XHJcblx0XHRpZiBAYWN0aXZlID09IC0xIHRoZW4gcmV0dXJuXHJcblx0XHRAcGxheWVyID0gMSAtIEBwbGF5ZXJcclxuXHRcdEBhY3RpdmUgPSAtMVxyXG5cdFx0QG9yaWdpbmFsID0gQGJvYXJkWy4uXVxyXG5cclxuXHRjYW5jZWwgOiAtPlxyXG5cdFx0QGJvYXJkID0gQG9yaWdpbmFsXHJcblx0XHRAYWN0aXZlID0gLTFcclxuXHJcblx0ZHJhdyA6IC0+XHJcblx0XHR0ZXh0QWxpZ24gQ0VOVEVSLENFTlRFUlxyXG5cdFx0dGV4dFNpemUgMzJcclxuXHRcdGJnIDBcclxuXHRcdGZvciBbeCx5LHR4dF0saSBpbiBAQlVUVE9OU1xyXG5cdFx0XHRmYyAwXHJcblx0XHRcdHNjIDFcclxuXHRcdFx0c3cgMlxyXG5cdFx0XHRpZiBpPD0yIGFuZCBAYWN0aXZlPT0tMSBvciBAYWN0aXZlPT1pIHRoZW4gY2lyY2xlIHgseSxAUkFESVVTXHJcblx0XHRcdGlmIGkgaW4gWzMsNF0gYW5kIEBhY3RpdmUhPS0xIHRoZW4gY2lyY2xlIHgseSxAUkFESVVTXHJcblx0XHRcdGlmIGk9PTUgYW5kIEBhY3RpdmU9PS0xIHRoZW4gY2lyY2xlIHgseSxAUkFESVVTXHJcblx0XHRcdGZjIDFcclxuXHRcdFx0c2MoKVxyXG5cdFx0XHRpZiBpPD0yIHRoZW4gdGV4dCBAYm9hcmRbaV0seCx5XHJcblx0XHRcdGlmIGk+PTMgdGhlbiB0ZXh0IHR4dCx4LHlcclxuXHRcdGZjIDEsQHBsYXllciwwXHJcblx0XHRjaXJjbGUgMjAgKyBAcGxheWVyICogMTYwLDIwLDEwXHJcblxyXG5cdGhpbnQgOiAtPlxyXG5cdFx0aWYgQGFjdGl2ZSAhPSAtMSB0aGVuIHJldHVyblxyXG5cdFx0W2EsYixjXSA9IEBib2FyZFxyXG5cdFx0Ym9hcmQgPSBpZiAoYl5jKSA8IGEgdGhlbiBbYl5jLGIsY10gZWxzZSBpZiAoYV5jKSA8IGIgdGhlbiBbYSxhXmMsY10gZWxzZSBpZiAoYV5iKSA8IGMgdGhlbiBbYSxiLGFeYl0gZWxzZSBbYSxiLGNdXHJcblx0XHRpZiBub3QgXy5pc0VxdWFsKGJvYXJkLEBib2FyZClcclxuXHRcdFx0QGJvYXJkID0gYm9hcmRcclxuXHRcdFx0QHBsYXllciA9IDEgLSBAcGxheWVyXHJcblxyXG5cdG1vdXNlUHJlc3NlZCA6IChteCxteSkgLT5cclxuXHRcdGluZGV4ID0gLTFcclxuXHRcdGZvciBidXR0b24saSBpbiBAQlVUVE9OU1xyXG5cdFx0XHRpZiBkaXN0KGJ1dHRvblswXSxidXR0b25bMV0sbXgsbXkpIDwgQFJBRElVUyB0aGVuIGluZGV4ID0gaVxyXG5cdFx0aWYgaW5kZXggPD0gMiB0aGVuIEBtb3ZlIGluZGV4XHJcblx0XHRpZiBpbmRleCA9PSAzIHRoZW4gQG9rKClcclxuXHRcdGlmIGluZGV4ID09IDQgdGhlbiBAY2FuY2VsKClcclxuXHRcdGlmIGluZGV4ID09IDUgdGhlbiBAaGludCgpXHJcblxyXG5zZXR1cCA9IC0+XHJcblx0Y3JlYXRlQ2FudmFzIDIwMCwyMDBcclxuXHRhcHAgPSBuZXcgTmltXHJcblx0YnV0dG9uICduZXdHYW1lJywoKSA9PiBhcHAubmV3R2FtZSgpXHJcblxyXG5kcmF3ID0gLT4gYXBwLmRyYXcoKVxyXG5tb3VzZVByZXNzZWQgPSAoZXZlbnQpIC0+IGFwcC5tb3VzZVByZXNzZWQgZXZlbnQueCwgZXZlbnQueVxyXG4iXX0=
//# sourceURL=c:\github\p5Dojo2\ID_Nim\coffee\sketch.coffee