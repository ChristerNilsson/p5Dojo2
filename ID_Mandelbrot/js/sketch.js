// Generated by CoffeeScript 2.4.1
var BITS, DEPTH, N, N1, SIZE, calc, mousePressed, reset, setup, state, undo, xdraw;

SIZE = 100;

BITS = 3;

N = 2 ** BITS;

N1 = N - 1;

DEPTH = 2 ** (3 * BITS);

state = {};

reset = function() {
  state.hist = [];
  [state.x, state.y, state.zoom] = [-0.5, 0, 0.01];
  return xdraw();
};

xdraw = function() {
  var b, cx, cy, f, g, i, j, l, len, r, ref, results;
  ref = range(-SIZE, SIZE);
  results = [];
  for (l = 0, len = ref.length; l < len; l++) {
    i = ref[l];
    results.push((function() {
      var len1, m, ref1, results1;
      ref1 = range(-SIZE, SIZE);
      results1 = [];
      for (m = 0, len1 = ref1.length; m < len1; m++) {
        j = ref1[m];
        cx = state.x + state.zoom * i;
        cy = state.y + state.zoom * j;
        f = calc(cx, cy);
        b = f % N;
        f = Math.floor(f / N);
        g = f % N;
        f = Math.floor(f / N);
        r = f % N;
        f = Math.floor(f / N);
        sc(r / N1, g / N1, b / N1);
        results1.push(point(SIZE + i, SIZE + j));
      }
      return results1;
    })());
  }
  return results;
};

undo = function() {
  if (state.hist.length > 0) {
    console.log('undo');
    [state.x, state.y, state.zoom] = state.hist.pop();
    return xdraw();
  }
};

calc = function(cx, cy) {
  var count, k, l, len, ref, x, y;
  [x, y] = [cx, cy];
  count = 0;
  ref = range(DEPTH);
  for (l = 0, len = ref.length; l < len; l++) {
    k = ref[l];
    if (2 > dist(x, y, 0, 0)) {
      count++;
    } else {
      return count;
    }
    [x, y] = [x * x - y * y + cx, 2 * x * y + cy];
  }
  return count;
};

mousePressed = function(event) {
  if (event.x > width || event.y > height) {
    return;
  }
  state.hist.push([state.x, state.y, state.zoom]);
  state.x = map(event.x, 0, 2 * SIZE, state.x - state.zoom * SIZE, state.x + state.zoom * SIZE);
  state.y = map(event.y, 0, 2 * SIZE, state.y - state.zoom * SIZE, state.y + state.zoom * SIZE);
  state.zoom /= 2;
  return xdraw();
};

setup = function() {
  createCanvas(200, 200);
  button('reset', reset);
  button('undo', undo);
  return reset();
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUEsSUFBQSxFQUFBLEtBQUEsRUFBQSxDQUFBLEVBQUEsRUFBQSxFQUFBLElBQUEsRUFBQSxJQUFBLEVBQUEsWUFBQSxFQUFBLEtBQUEsRUFBQSxLQUFBLEVBQUEsS0FBQSxFQUFBLElBQUEsRUFBQTs7QUFBQSxJQUFBLEdBQU87O0FBQ1AsSUFBQSxHQUFPOztBQUNQLENBQUEsR0FBSSxDQUFBLElBQUc7O0FBQ1AsRUFBQSxHQUFLLENBQUEsR0FBRTs7QUFDUCxLQUFBLEdBQVEsQ0FBQSxJQUFHLENBQUMsQ0FBQSxHQUFFLElBQUg7O0FBRVgsS0FBQSxHQUFRLENBQUE7O0FBRVIsS0FBQSxHQUFRLFFBQUEsQ0FBQSxDQUFBO0VBQ1AsS0FBSyxDQUFDLElBQU4sR0FBYTtFQUNiLENBQUMsS0FBSyxDQUFDLENBQVAsRUFBUyxLQUFLLENBQUMsQ0FBZixFQUFpQixLQUFLLENBQUMsSUFBdkIsQ0FBQSxHQUErQixDQUFDLENBQUMsR0FBRixFQUFPLENBQVAsRUFBVSxJQUFWO1NBQy9CLEtBQUEsQ0FBQTtBQUhPOztBQUtSLEtBQUEsR0FBUyxRQUFBLENBQUEsQ0FBQTtBQUNSLE1BQUEsQ0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsRUFBQTtBQUFBO0FBQUE7RUFBQSxLQUFBLHFDQUFBOzs7O0FBQ0M7QUFBQTtNQUFBLEtBQUEsd0NBQUE7O1FBQ0MsRUFBQSxHQUFLLEtBQUssQ0FBQyxDQUFOLEdBQVUsS0FBSyxDQUFDLElBQU4sR0FBVztRQUMxQixFQUFBLEdBQUssS0FBSyxDQUFDLENBQU4sR0FBVSxLQUFLLENBQUMsSUFBTixHQUFXO1FBQzFCLENBQUEs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Q29udGVudCI6WyJTSVpFID0gMTAwXHJcbkJJVFMgPSAzIFxyXG5OID0gMioqQklUU1xyXG5OMSA9IE4tMVxyXG5ERVBUSCA9IDIqKigzKkJJVFMpXHJcblxyXG5zdGF0ZSA9IHt9XHJcblxyXG5yZXNldCA9IC0+XHJcblx0c3RhdGUuaGlzdCA9IFtdXHJcblx0W3N0YXRlLngsc3RhdGUueSxzdGF0ZS56b29tXSA9IFstMC41LCAwLCAwLjAxXVxyXG5cdHhkcmF3KClcclxuXHJcbnhkcmF3ICA9IC0+XHJcblx0Zm9yIGkgaW4gcmFuZ2UgLVNJWkUsU0laRVxyXG5cdFx0Zm9yIGogaW4gcmFuZ2UgLVNJWkUsU0laRVxyXG5cdFx0XHRjeCA9IHN0YXRlLnggKyBzdGF0ZS56b29tKmlcclxuXHRcdFx0Y3kgPSBzdGF0ZS55ICsgc3RhdGUuem9vbSpqXHJcblx0XHRcdGYgPSBjYWxjIGN4LGN5XHJcblx0XHRcdGIgPSBmICUgTjsgZiAvLz0gTlxyXG5cdFx0XHRnID0gZiAlIE47IGYgLy89IE5cclxuXHRcdFx0ciA9IGYgJSBOOyBmIC8vPSBOXHJcblx0XHRcdHNjIHIvTjEsIGcvTjEsIGIvTjFcclxuXHRcdFx0cG9pbnQgU0laRStpLFNJWkUralxyXG5cclxudW5kbyA9IC0+XHJcblx0aWYgc3RhdGUuaGlzdC5sZW5ndGggPiAwIFxyXG5cdFx0Y29uc29sZS5sb2cgJ3VuZG8nXHJcblx0XHRbc3RhdGUueCxzdGF0ZS55LHN0YXRlLnpvb21dID0gc3RhdGUuaGlzdC5wb3AoKVxyXG5cdFx0eGRyYXcoKVxyXG5cclxuY2FsYyA9IChjeCxjeSkgLT5cclxuXHRbeCx5XSA9IFtjeCxjeV1cclxuXHRjb3VudCA9IDBcclxuXHRmb3IgayBpbiByYW5nZSBERVBUSFxyXG5cdFx0aWYgMiA+IGRpc3QgeCx5LDAsMCB0aGVuIGNvdW50KysgZWxzZSByZXR1cm4gY291bnRcclxuXHRcdFt4LHldID0gW3gqeC15KnkrY3gsIDIqeCp5K2N5XVxyXG5cdGNvdW50XHJcblxyXG5tb3VzZVByZXNzZWQgPSAoZXZlbnQpIC0+XHJcblx0aWYgZXZlbnQueCA+IHdpZHRoIG9yIGV2ZW50LnkgPiBoZWlnaHQgdGhlbiByZXR1cm5cclxuXHRzdGF0ZS5oaXN0LnB1c2ggW3N0YXRlLngsc3RhdGUueSxzdGF0ZS56b29tXVxyXG5cdHN0YXRlLnggPSBtYXAgZXZlbnQueCwgMCwgMipTSVpFLCBzdGF0ZS54LXN0YXRlLnpvb20qU0laRSwgc3RhdGUueCtzdGF0ZS56b29tKlNJWkVcclxuXHRzdGF0ZS55ID0gbWFwIGV2ZW50LnksIDAsIDIqU0laRSwgc3RhdGUueS1zdGF0ZS56b29tKlNJWkUsIHN0YXRlLnkrc3RhdGUuem9vbSpTSVpFXHJcblx0c3RhdGUuem9vbSAvPSAyXHJcblx0eGRyYXcoKVxyXG5cclxuc2V0dXAgPSAtPlxyXG5cdGNyZWF0ZUNhbnZhcyAyMDAsMjAwXHJcblx0YnV0dG9uICdyZXNldCcscmVzZXRcclxuXHRidXR0b24gJ3VuZG8nLHVuZG9cclxuXHRyZXNldCgpXHJcbiJdfQ==
//# sourceURL=c:\github\p5Dojo2\ID_Mandelbrot\coffee\sketch.coffee